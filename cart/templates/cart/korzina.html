{% load static %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{% static 'css\korzina.css'%}">

    <title>Document</title>
    <style>
        input {width: 100%;}
        body, :root {background-color:#ecf6d9}
        .modal-header,.modal-body,.modal-footer {background-color: #fffdf3;}
    </style>
</head>

<header>
<ul class="menu">
  <li><a href="{% url 'catalog' %}">Вернуться к каталогу</a></li>
</ul>

{% with total_items=cart|length %}
    {% if cart|length > 0 %}
        <button class="cart" id="cart">
          <img class="cart__image" src="{% static '/img/cart.png' %}" width="75px" height="50px" alt="Cart" />
          <div class="cart__num" id="cart_num">{{ total_items }}</div>
        </button>



    {% else %}
        <button class="cart" id="cart">
          <img class="cart__image" src="{% static '/img/cart.png' %}" width="75px" height="50px" alt="Cart" />
          <div class="cart__num" id="cart_num">{{ total_items }}</div>
        </button>


    {% endif %}
{% endwith %}
</header>


<body>
<div class="shopping-cart">
    {% with total_items=cart|length %}
    {% if cart|length > 0 %}

      <div class="title3">
            <div class="naimenovania">
                <p class="p1">Фото</p>
                <p class="p2">Имя товара</p>
                <p class="p3">Количество</p>
                <p class="p4">Цена</p>
            </div>
      </div>

      <!-- Товар #1 -->


    {% for item in cart %}
        {% with product=item.product %}
          <div class="item">
            <div class="image">
              <img src="
                                {% if product.image %}
                                    {{ product.image.url }}
                                {% else %}
                                    {% static "img/no_image.png" %}
                                {% endif %}" width="150px" height="150px" alt="" />
            </div>

            <div class="description2">
              <p>{{ product.name }}</p>
            </div>
              <div class="total-price2">{{ item.quantity }} шт</div>
            <div class="total-price2">{{ item.total_price }} ₽</div>

            <div class="buttons-delete"><a href="{% url "cart:cart_remove" product.id%}"><button class="del-b">Удалить товар</button></a>

            </div>
          </div>
        {% endwith %}

    {% endfor %}
<div class="get-total-price" >Итоговая цена за {{ total_items }} шт. <p>{{ cart.get_total_price }} ₽</p> </div>
</div>




  <!-- Модальное окно -->
      <div class="modal-content" style="min-width: 300px;">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel" >Отправьте ваш заказ</h5>
<!--          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Закрыть"></button>-->
        </div>
        <div class="modal-body">
        <form method="POST">
            {% csrf_token %}
            <div>
            {{ form.as_p }}
            </div>
            <input name="price" value="{{ cart.get_total_price }}" readonly style="display: none">
            <input type="submit" style="font-size: 17px" value="  Отправить  ">
        </form>
        </div>
        <div class="modal-footer">
        </div>
      </div>



    {% else %}

      <div class="title" >
            Shopping
      </div>
      <div class="title2" style="padding: 30px;">
            Корзина пустая
      </div>
    </div>

    {% endif %}
{% endwith %}

<footer></footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>